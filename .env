# ==============================================================================
# PRODUCTION ENVIRONMENT CONFIGURATION
# ==============================================================================
# Voice AI Ordering System - Captain Jay's Fish & Chicken
# Version: 1.0.0
# Last Updated: 2026-01-21
#
# INSTRUCTIONS:
# 1. Copy this file to .env
# 2. Fill in all required values (marked with <REQUIRED>)
# 3. Adjust optional values as needed
# 4. Never commit .env to version control
# ==============================================================================

# ==============================================================================
# CORE APPLICATION
# ==============================================================================

# Environment: production, staging, development
ENVIRONMENT=production

# Application metadata
APP_NAME=voice-ai-agent
APP_VERSION=1.0.0

# Server configuration
HOST=0.0.0.0
PORT=8000

# Logging
LOG_LEVEL=INFO
DEBUG=false

# LLM Provider: claude, openai
LLM_PROVIDER=claude

# ==============================================================================
# TELEPHONY (TWILIO)
# ==============================================================================

# Twilio credentials
TWILIO_ACCOUNT_SID=<REQUIRED>  # Example: ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
TWILIO_AUTH_TOKEN=<REQUIRED>   # Example: your_auth_token_here
TWILIO_PHONE_NUMBER=<REQUIRED> # Example: +12025551234 (E.164 format)

# Call transfer (optional)
TWILIO_TRANSFER_NUMBER=+12025555678  # Human operator number (E.164 format)

# ==============================================================================
# SPEECH SERVICES (GOOGLE CLOUD)
# ==============================================================================

# Google Cloud credentials (choose ONE method)
GOOGLE_APPLICATION_CREDENTIALS=<REQUIRED>  # Path to JSON file
# OR
# GOOGLE_CLOUD_CREDENTIALS_JSON=<REQUIRED> # JSON content as string

# Google Cloud project (optional)
GOOGLE_CLOUD_PROJECT=my-project-id

# Audio configuration
AUDIO_SAMPLE_RATE=16000
AUDIO_ENCODING=LINEAR16
AUDIO_CHUNK_SIZE=4096

# Voice settings (TTS)
SPEAKING_RATE=1.0    # Range: 0.25-4.0 (1.0 = normal)
PITCH=0.0            # Range: -20.0 to 20.0 (0.0 = neutral)
VOLUME_GAIN_DB=0.0   # Range: -96.0 to 16.0 (0.0 = neutral)

# ==============================================================================
# AI / LLM (ANTHROPIC CLAUDE)
# ==============================================================================

# Anthropic API
ANTHROPIC_API_KEY=<REQUIRED>  # Example: sk-ant-api03-...

# Model configuration
CLAUDE_MODEL=claude-sonnet-4-20250514
CLAUDE_MAX_TOKENS=1024
CLAUDE_TEMPERATURE=0.7

# System prompt (multiline supported)
SYSTEM_AGENT_PROMPT="You are Captain Jay's AI phone assistant. You help customers place orders in a friendly, efficient manner. Always be polite, confirm orders clearly, and offer helpful suggestions. When a customer wants to speak to a human, transfer them immediately. Never invent menu items - only suggest items from the provided menu. Support English, Spanish, and Arabic. Think internally in English but respond in the customer's language."

# ==============================================================================
# DATABASE (SUPABASE)
# ==============================================================================

# Supabase credentials
SUPABASE_URL=<REQUIRED>  # Example: https://abcdefgh.supabase.co
SUPABASE_KEY=<REQUIRED>  # Example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# ==============================================================================
# LANGUAGE & LOCALIZATION
# ==============================================================================

# Default language (must be in supported list)
DEFAULT_LANGUAGE=en

# Supported languages (comma-separated)
SUPPORTED_LANGUAGES=en,ar,es

# ==============================================================================
# FEATURE FLAGS
# ==============================================================================

# Core features
ENABLE_STREAMING_STT=true     # Real-time speech recognition
ENABLE_STREAMING_TTS=true     # Real-time speech synthesis
ENABLE_BARGE_IN=true          # Allow customer to interrupt AI
ENABLE_MEMORY=true            # Conversation memory

# Advanced features
ENABLE_MULTILINGUAL=true      # Multi-language support
ENABLE_CALL_TRANSFER=true     # Transfer to human
ENABLE_UPSELL=true            # Smart upsell suggestions
ENABLE_SMS=true               # SMS confirmations

# Optional features
ENABLE_CALL_RECORDING=false   # Record calls (legal compliance required)
ENABLE_ANALYTICS=true         # Usage analytics

# ==============================================================================
# TIMEOUTS (SECONDS)
# ==============================================================================

# Speech-to-Text
STT_SILENCE_TIMEOUT=3.0       # Silence detection threshold
STT_STREAM_TIMEOUT=305.0      # Max stream duration (Google limit)

# Text-to-Speech
TTS_SYNTHESIS_TIMEOUT=10.0    # Max synthesis time

# Translation
TRANSLATION_TIMEOUT=3.0       # Max translation time per request

# Database
DB_READ_TIMEOUT=5.0           # Max read operation time
DB_WRITE_TIMEOUT=10.0         # Max write operation time

# Call-level timeouts
MAX_CALL_DURATION=900         # 15 minutes max per call
MAX_SILENCE_DURATION=30       # 30 seconds silence before warning

# ==============================================================================
# WATCHDOG LIMITS
# ==============================================================================

# Conversation limits
MAX_TURNS_PER_CALL=100        # Max conversation turns
MAX_CONVERSATION_TURNS=200    # Max turns stored in memory

# Error limits
MAX_AI_ERRORS=3               # Max AI errors before fallback
MAX_SILENCE_STRIKES=3         # Max silence warnings before ending

# Order limits
MAX_ORDER_ITEMS=50            # Max items per order
MAX_MENU_ITEMS=1000           # Max items in menu

# Upsell limits
MAX_UPSELLS_PER_CALL=3        # Total upsells per call

# Queue limits
MAX_WRITE_QUEUE_SIZE=1000     # Database write queue
MAX_SMS_QUEUE_SIZE=500        # SMS send queue

# ==============================================================================
# TRANSFER RULES
# ==============================================================================

# Transfer triggers (keywords that trigger human transfer)
TRANSFER_KEYWORDS=manager,supervisor,human,person,representative,complaint,cancel,refund

# Transfer timeout
TRANSFER_ATTEMPT_TIMEOUT=30   # Seconds before transfer attempt fails

# ==============================================================================
# VOICE MAPS (GOOGLE CLOUD TTS)
# ==============================================================================

# English voices
VOICE_EN_NAME=en-US-Neural2-F
VOICE_EN_GENDER=FEMALE
VOICE_EN_LANGUAGE_CODE=en-US

# Arabic voices
VOICE_AR_NAME=ar-XA-Standard-A
VOICE_AR_GENDER=FEMALE
VOICE_AR_LANGUAGE_CODE=ar-XA

# Spanish voices
VOICE_ES_NAME=es-ES-Neural2-A
VOICE_ES_GENDER=FEMALE
VOICE_ES_LANGUAGE_CODE=es-ES

# ==============================================================================
# SAFETY & COMPLIANCE
# ==============================================================================

# Rate limiting
MAX_CONCURRENT_CALLS=50       # Max simultaneous calls
RATE_LIMIT_PER_PHONE=5        # Max calls per phone per hour

# Data retention (days)
CALL_LOG_RETENTION_DAYS=90
TRANSCRIPT_RETENTION_DAYS=30
RECORDING_RETENTION_DAYS=7    # If recording enabled

# Privacy
MASK_PHONE_IN_LOGS=true       # Mask phone numbers in logs
MASK_CREDIT_CARD=true         # Mask payment info (if applicable)

# ==============================================================================
# PERFORMANCE TUNING
# ==============================================================================

# Concurrency
MAX_CONCURRENT_TRANSLATIONS=20  # Max parallel translations
MAX_CONCURRENT_SYNTHESIS=10     # Max parallel TTS requests

# Caching
MENU_CACHE_TTL=300            # 5 minutes
TRANSLATION_CACHE_TTL=3600    # 1 hour
TRANSLATION_CACHE_SIZE=500    # Max cached translations

# Retry configuration
MAX_RETRIES_DB=3              # Database operation retries
MAX_RETRIES_SMS=3             # SMS send retries
MAX_RETRIES_TRANSLATION=2     # Translation retries
RETRY_DELAY_SECONDS=1.0       # Base retry delay

# Circuit breaker
CIRCUIT_BREAKER_THRESHOLD=5   # Failures before opening
CIRCUIT_BREAKER_TIMEOUT=30    # Seconds before testing recovery

# ==============================================================================
# MONITORING & OBSERVABILITY
# ==============================================================================

# Health check
HEALTH_CHECK_INTERVAL=10      # Seconds between health checks

# Metrics
ENABLE_METRICS=true           # Prometheus metrics
METRICS_PORT=9090

# Tracing
ENABLE_TRACING=false          # Distributed tracing
TRACE_SAMPLE_RATE=0.1         # 10% sampling

# ==============================================================================
# OPTIONAL: OPENAI (ALTERNATIVE LLM)
# ==============================================================================

# Only required if LLM_PROVIDER=openai
# OPENAI_API_KEY=sk-...
# OPENAI_MODEL=gpt-4
# OPENAI_MAX_TOKENS=1024
# OPENAI_TEMPERATURE=0.7

# ==============================================================================
# DEVELOPMENT / STAGING OVERRIDES
# ==============================================================================

# Uncomment for development/staging environments
# DEBUG=true
# LOG_LEVEL=DEBUG
# ENABLE_CALL_RECORDING=true
# MAX_CALL_DURATION=60
# CIRCUIT_BREAKER_THRESHOLD=10

# ==============================================================================
# END OF CONFIGURATION
# ==============================================================================
