# ============================================================================
# AI VOICE ORDERING SYSTEM - ENVIRONMENT CONFIGURATION
# ============================================================================
# Enterprise Production Template v2.0
# Last Updated: 2026-01-21
#
# INSTRUCTIONS:
# 1. Copy this file to .env
# 2. Fill in all required values marked with <REQUIRED>
# 3. Optional values can be left as defaults
# 4. Never commit .env to version control!
# ============================================================================

# ============================================================================
# TWILIO (Voice/SMS) - REQUIRED
# ============================================================================
TWILIO_ACCOUNT_SID=<REQUIRED>
TWILIO_AUTH_TOKEN=<REQUIRED>
TWILIO_PHONE_NUMBER=<REQUIRED>              # Format: +1234567890
TWILIO_TRANSFER_NUMBER=                     # Optional: Human transfer

# ============================================================================
# OPENAI GPT CONFIGURATION (AI) - REQUIRED
# ============================================================================
# Required for conversation AI (GPT-4o-mini)
OPENAI_API_KEY=<REQUIRED>                       # Your OpenAI API key
LLM_MODEL=gpt-4o-mini                           # Model: gpt-4o-mini (recommended)
LLM_MAX_TOKENS=1024                             # Max response tokens
LLM_TEMPERATURE=0.7                             # Creativity (0.0-1.0)

# ============================================================================
# DEEPGRAM (Speech-to-Text) - REQUIRED
# ============================================================================
# Cost-optimized STT: $0.0043/min (82% cheaper than Google)
DEEPGRAM_API_KEY=<REQUIRED>                     # Get from console.deepgram.com
DEEPGRAM_MODEL=nova-2                           # Best price/performance model

# ============================================================================
# GOOGLE CLOUD (Text-to-Speech & Translation) - REQUIRED
# ============================================================================
GOOGLE_APPLICATION_CREDENTIALS=./google-creds.json
GOOGLE_CLOUD_PROJECT=                       # Optional

# ============================================================================
# SUPABASE (Database) - REQUIRED
# ============================================================================
SUPABASE_URL=<REQUIRED>
SUPABASE_KEY=<REQUIRED>

# ============================================================================
# AI SYSTEM PROMPT - Restaurant Assistant Behavior
# ============================================================================
# This defines how your AI receptionist behaves and responds to customers
SYSTEM_PROMPT="You are a friendly and professional AI phone receptionist for Captain Jay's Restaurant. Your primary job is to take food orders over the phone with warmth and efficiency.

PERSONALITY:
- Warm, conversational, and helpful (like talking to a friendly restaurant staff member)
- Patient and understanding with customers
- Enthusiastic about the food and menu items
- Natural and human-like in your responses (avoid sounding robotic)
- Professional but not overly formal

YOUR CONVERSATION PROCESS:
1. GREETING: Start with a warm welcome
   Example: 'Hi! Thanks for calling Captain Jay's. What can I get for you today?'

2. TAKING THE ORDER: Listen carefully and acknowledge each item
   Example: 'Great choice! I'll add a cheeseburger for you.'

3. SUGGESTIONS: Naturally suggest add-ons or popular items
   Example: 'Would you like to add fries with that? They're really popular!'

4. CONFIRMATION: Always repeat the order back to confirm
   Example: 'Perfect! So that's one cheeseburger with fries and a soda. Is that correct?'

5. ADDITIONAL ITEMS: Ask if they want anything else
   Example: 'Can I get you anything else today?'

6. CLOSING: Provide total and next steps warmly
   Example: 'Your total is $19. We'll have that ready for pickup in about 20 minutes. Thanks for calling!'

IMPORTANT RULES:
- Keep responses SHORT - aim for 1-2 sentences maximum
- Don't list the entire menu unless specifically asked
- If a customer is uncertain, suggest 2-3 popular items rather than everything
- Always confirm the full order before finishing the call
- Use natural, casual language (it's okay to say 'um', 'so', etc.)
- If you don't understand something, politely ask them to repeat: 'Sorry, could you say that again?'
- Never make up menu items or prices - only use what's listed below
- If asked about something not on the menu, politely say it's not available and suggest alternatives

MENU ITEMS WITH PRICES:

BURGERS:
- Classic Burger: $12
- Cheeseburger: $14
- Bacon Burger: $15
- Veggie Burger: $13

PIZZA (Large, serves 2-3):
- Margherita Pizza: $18
- Pepperoni Pizza: $20
- Supreme Pizza: $24
- Veggie Pizza: $19

SIDES:
- French Fries: $5
- Onion Rings: $6
- Garden Salad: $7
- Chicken Wings (8 pieces): $9

DRINKS:
- Soda (can): $3
- Bottled Water: $2
- Fresh Juice: $4
- Beer: $6

SPECIAL INSTRUCTIONS:
- Minimum order for delivery: $25
- Pickup orders ready in 15-20 minutes
- Delivery takes 30-45 minutes
- Maximum order value: $200
- We accept all major credit cards
- Tax will be added at checkout

HANDLING COMMON SITUATIONS:
- If order is under $25 for delivery: 'Just so you know, there's a $25 minimum for delivery. Would you like to add anything else, or would pickup work better?'
- If customer asks about ingredients: 'I can check with the kitchen. Generally our [item] has [common ingredients]. Any allergies I should know about?'
- If customer wants modifications: 'Absolutely! We can do that. I'll add a note to make it [modification].'
- If system is unclear: 'I want to make sure I get this right. Could you repeat that item?'

Remember: Your goal is to make ordering easy and pleasant. Be helpful, be friendly, and make sure customers feel taken care of!"

# ============================================================================
# APPLICATION
# ============================================================================
APP_NAME=AI Voice Ordering
APP_VERSION=2.0.0
ENVIRONMENT=production
DEBUG=false
HOST=0.0.0.0
PORT=8000

# ============================================================================
# AUDIO
# ============================================================================
AUDIO_SAMPLE_RATE=16000
AUDIO_ENCODING=LINEAR16
SPEAKING_RATE=1.0
PITCH=0.0
VOLUME_GAIN_DB=0.0

# ============================================================================
# VOICES
# ============================================================================
VOICE_EN_NAME=en-US-Neural2-F
VOICE_AR_NAME=ar-XA-Standard-A
VOICE_ES_NAME=es-ES-Neural2-A

# ============================================================================
# LANGUAGES
# ============================================================================
SUPPORTED_LANGUAGES=en,ar,es
DEFAULT_LANGUAGE=en
STT_LANGUAGE=en-US

# ============================================================================
# TIMEOUTS
# ============================================================================
MAX_CALL_DURATION=900
MAX_SILENCE_DURATION=30
TRANSLATION_TIMEOUT=3.0
STT_SILENCE_TIMEOUT=3.0
STT_STREAM_TIMEOUT=305.0
STT_MAX_RECONNECT=3
STT_RECONNECT_DELAY=2

# ============================================================================
# RETRY & RESILIENCE
# ============================================================================
MAX_RETRIES_DB=3
MAX_RETRIES_SMS=3
MAX_RETRIES_TRANSLATION=2
RETRY_DELAY_SECONDS=1.0
CIRCUIT_BREAKER_THRESHOLD=5
CIRCUIT_BREAKER_TIMEOUT=30

# ============================================================================
# QUEUE & CONCURRENCY
# ============================================================================
MAX_SMS_QUEUE_SIZE=500
MAX_WRITE_QUEUE_SIZE=1000
BATCH_WRITE_SIZE=10
BATCH_WRITE_INTERVAL=2.0
SMS_PROCESSING_INTERVAL=1.0
MAX_CONCURRENT_CALLS=50
MAX_CONCURRENT_SYNTHESIS=10
MAX_CONCURRENT_TRANSLATIONS=20

# ============================================================================
# CACHE
# ============================================================================
TRANSLATION_CACHE_TTL=3600
TRANSLATION_CACHE_SIZE=500
MENU_CACHE_TTL=300
MENU_CACHE_SIZE=100

# ============================================================================
# CONVERSATION LIMITS
# ============================================================================
MAX_CONVERSATION_TURNS=200
MAX_TURNS_PER_CALL=100
MAX_AI_ERRORS=3
MAX_UPSELLS_PER_CALL=3

# ============================================================================
# HEALTH CHECKS
# ============================================================================
HEALTH_CHECK_INTERVAL=10

# ============================================================================
# FEATURE FLAGS
# ============================================================================
FEATURE_STREAMING_STT=true
FEATURE_STREAMING_TTS=true
FEATURE_BARGE_IN=true
FEATURE_CALL_TRANSFER=true
FEATURE_UPSELL_SUGGESTIONS=true
FEATURE_SMS_CONFIRMATIONS=true
FEATURE_MULTILINGUAL=true
FEATURE_MEMORY=true
FEATURE_CALL_RECORDING=false
FEATURE_ANALYTICS=true

# ============================================================================
# MONITORING (Optional)
# ============================================================================
PROMETHEUS_PORT=9090
LOG_LEVEL=INFO
STRUCTURED_LOGGING=true

# ============================================================================
# COST ESTIMATES (Monthly - OPTIMIZED):
# ============================================================================
# Cost per minute: $0.025 (44% cheaper than original!)
# Cost per 3-min call: $0.074
#
# Monthly estimates:
# - 300 calls/month:   $22  (was $40)
# - 1,000 calls/month: $74  (was $132)
# - 3,000 calls/month: $222 (was $396)
# 
# Breakdown per call:
# - Twilio Voice:      $0.0140
# - Deepgram STT:      $0.0043 ✅ (82% cheaper than Google!)
# - GPT-4o-mini:       $0.0020 ✅ (Best GPT model for price)
# - Google TTS:        $0.0003
# - Translation:       $0.0013
# - SMS:               $0.0027
# 
# TOTAL: $0.025/min
# 
# Annual savings vs original: $2,088/year (at 3K calls/month)
# ============================================================================
